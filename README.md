# ListElixr Subscribe Form

This is a widget that allows clients to embed a form on their website to automatically create subscriptions in ListElxir. The OAuth access token must be generated by an administrator. Once the access token has been generated, copy/paste the JavaScript code. This plugin is highly customizable, so the form can look however you desire.

## Basic Usage

`https://unpkg.com/listelixr-js@VERSION/dist/ListElixr.umd.cjs`

Note, where `VERSION` is, it must be various formats such as `^1.0` `~1.0` `1.0.5`. It's best to lock into a hard version on client sites because that version will work indefinitely and updates wont impact it.

```html
<script src="https://unpkg.com/listelixr-js@1.0.0-beta.5/dist/ListElixr.umd.cjs"></script>

<script>
var el = document.querySelector('#foo');
var key = 'the-access-token-goes-here';

ListElixr.subscribeForm(el, {
    key: key,
    tags: ['foo', 'bar'], // optional
    source: 'XXXXX', // optional
    channel: 'YYYYY', // optional
    fields: ['email', 'first', 'last']
});
</script>

```

### Available Fields

The following are the standard fields:

`email`,  `first`, `last`, `street`, `city`, `state`, `zip`, and `phone`.

The order of the fields determine the order they appear in the form. Should you need to provide custom html structure for the fields, you may also pass an `HTMLElement` that contains an input field with one of the accepted field names.

## Customizeable Themes

The following will extend the default theme. You could create an entirely new theme from scratch, but this example just shows how to override the submit button color.

```html
<script src="https://unpkg.com/listelixr-js@1.0.0-beta.5/dist/ListElixr.umd.cjs"></script>

<script>
var el = document.querySelector('#foo');
var key = 'the-access-token-goes-here';

// Extend the default theme and override the button colors.
var theme = ListElixr.defaultTheme.merge({
    'button': {
        background: 'red',

        '&:active': {
            background: 'darkred'
        },

        '&:focus': {
            boxShadow: '0px 0px 0px 3px rgb(255, 0, 0, .5)',
        }
    }
});

ListElixr.subscribeForm(el, {
    key: key,
    theme: theme,
    fields: ['email', 'first', 'last']
});
</script>
```

### CSS Conflicts

Should the CSS of the form and client website conflict, you may have to add `!important` or more speficity to the CSS rules so the form takes precedent. This shouldn't happen by default, as the CSS in the plugin is scoped. But its certainly still possible.

For example, lets say the client CSS was overriding the border. You could fix it like so...

```js
var theme = ListElixr.defaultTheme.merge({
    '.form-control': {
        border: '1px solid #e0e0e0 !important',
    }
});
```

### Creating a Custom Theme

It's generally advised to start from the `base` theme, which is only a reset stylesheet. This will ensure everything renders correctly across different browsers.

```js
var theme = ListElixr.base.merge({
    'button': {
        // your button css here
    },
    'input, select, textarea': {
        // your form field css here
    }
});
```

However, should you want to start completely from scratch you can still do so.

```js
var theme = ListElixr.theme({
    'button': {
        // your button css here
    },
    'input, select, textarea': {
        // your form field css here
    }
});
```

### CSS Class Name

Should you need the derived CSS class name that is used to scope the css, you can get it using the following code:

```js
var theme = ListElixr.defaultTheme;

console.log(theme.className.value);
console.log(theme.css.value); // Gets the CSS object.
```

## Access Tokens

Each access token is scoped to a catalog id. This ensures users can only be subscribed to a predetermined catalog, and can never be determined by the request body. To generate an access token, you must know the CLIENT_ID and CLIENT_SECRET of the ListElixr Client Credentials Grant.

Run the following command on the Elxir server. Be sure to replace `CLIENT_ID` `CLIENT_SECRET` AND `CATALOG_ID` with the actual values. The scope `client-api` is also required.

```bash
php artisan passport:client:access-token
    --id=CLIENT_ID
    --secret=CLIENT_SECRET
    --scope="catalog-CATALOG_ID client-api"
```

#### Variables

`CLIENT_ID` is the OAuth Client ID. \
`CLIENT_SECRET` is the `secret` value for the given `CLIENT_ID` \
`CATALOG_ID` is the id of the catalog you wish to subscribe users.
